/* Emailsuggest component for jQuery ( AMD Module ) | MIT Licenses | 2013-10-27 */
define(function(){var n={data:null,zIndex:9998,space:0},h=$(document),k=$(window),l={},p=/@/,f,g,e={createSuggest:function(a){var d='<ul class="ecope_emailsuggest" style="position:absolute;z-index:'+a.zIndex+'">',b,c;$.each(a.data,function(a,b){d+="<li>@"+b+"</li>"});d+="</ul>";b=$(d).appendTo(a.context.body).on("mouseover","li",function(){var a=$(this);a.hasClass("current")||(c.filter(".current").removeClass("current"),a.addClass("current"))}).on("click","li",function(){var b=$(this).text();a.target.val(b).trigger("likeselected",
[b])});c=b.children("li").each(function(){$(this).data("html",this.innerHTML)});a.itemElem=c;a.suggestElem=b},setPosition:function(a){var d=a.suggestElem,b=a.target,c=b.offset(),e=b.outerWidth(),q=b.outerHeight(),b=parseInt(b.css("borderBottomWidth"));f=f||parseInt(d.css("borderLeftWidth"));g=g||parseInt(d.css("borderRightWidth"));d.css({top:c.top+q-b+a.space+"px",left:c.left+"px",width:e-f-g+"px",display:"block"})},render:function(a){var d=a.value,b=a.target,c=b.data("value"),e=!1;d!==c&&(b.data("value",
d),e=p.test(d),a.itemElem.each(function(){var a=$(this),b;e?(b=a.text(),~b.indexOf(d)?a.css("display","block"):a.css("display","none").removeClass("current")):a.css("display","block").text(d+a.data("html"))}))},keyup:function(a,d){var b=d.which;13===b||9===b?e.close(a):(b=a.target[0].value.trim(),""!==b&&(a.suggestElem.is(":hidden")&&(e.setPosition(a),k.on("resize.emailsuggest",function(){e.setPosition(a)}),h.on("click.emailsuggest",function(b){b.target!==a.target[0]&&e.close(a)})),a.value=b,e.render(a)))},
keydown:function(a,d){var b;switch(d.which){case 38:e.keyMove(a,!1);d.preventDefault();break;case 40:e.keyMove(a,!0);d.preventDefault();break;case 13:b=a.itemElem.filter(".current"),b.length&&(b=b.text(),a.target.val(b).trigger("likeselected",[b])),d.preventDefault()}},keyMove:function(a,d){var b=d?"next":"prev",c=a.itemElem.filter(":visible"),e=c.first(),f=c.last();if(1!==c.length){c=c.filter(".current");c.length?(c.removeClass("current"),c=c[b]()):c=e;if(c.is(":hidden"))for(c=c[b]();c.length&&!c.is(":visible");)c=
c[b]();c.length||(c=d?e:f)}c.addClass("current")},close:function(a){a=a.suggestElem;a.is(":visible")&&(a.css("display","none"),k.off("resize.emailsuggest"),h.off("click.emailsuggest"))},init:function(a){var d=a.target;d.attr("autocomplete","off").on("focus.emailsuggest",function(){var b=this[$.expando],c=this.value;void 0===l[b]&&(l[b]=!0,e.createSuggest(a),d.data("value",c))}).on("keydown.emailsuggest",function(b){e.keydown(a,b)}).on("keyup.emailsuggest",function(b){e.keyup(a,b)})}},m=function(a,
d){a=$(a).eq(0);d=d||{};if(a.length){var b=$.extend({},n,d);b.target=a;b.context=a[0].ownerDocument;e.init(b);this.__o__=b}};m.prototype={on:function(a,d){if(!this.__o__)return this;var b=this;b.__o__.target.on("like"+a,function(c,e){c.type=a;c.value=e;d.call(b,c);c.stopPropagation()});return this},un:function(a){this.__o__&&this.__o__.target.off("like"+a);return this}};$.ui||($.ui={});$.ui.EmailSuggest=m});
